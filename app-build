from modules.polyfit import Polyfit
import optparse

# python3 app-build --npzfile dummy_data/fits.npz --input_h5 dummy_data/inputdata.h5 --order 3 --computecov
if __name__ == "__main__":
    #create Polyfit object from command line
    op = optparse.OptionParser(usage=__doc__)

    op.add_option("--npzfile", dest = "npzfile", help="ends with .npz")
    op.add_option("--computecov", dest = "covariance", help='find covariance in fit', action='store_true', default = False)
    op.add_option("--sample", dest="sample", type=int, default=None, help="Number of runs to sample")
    op.add_option("--input_h5", dest = "input_h5", default=None, help="h5 file with input")
    op.add_option("--order", dest="order", type=int, default=None, help="Polynomial order of numerator")
    op.add_option("--regmode", dest = "regmode", default=None, help="regression type")
    op.add_option("--regparam", dest = "regparam", default=None, help="reg param")
    opts, args = op.parse_args()

    kwargs = {}
    for option in ["sample", "input_h5", "order", "regmode", "regparam"]:
        if hasattr(opts, option):
            kwargs[option] = getattr(opts, option)
    p = Polyfit(opts.npzfile, covariance = opts.covariance, **kwargs)
